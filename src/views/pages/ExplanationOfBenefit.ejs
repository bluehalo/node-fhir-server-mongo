<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('../partials/head'); %>
</head>
<body class="container">

<header>
  <%- include('../partials/header', {resources: resources}); %>
</header>

<main>
  <div class="jumbotron">
    <% resources.forEach(function(res){ %>
        <%- include('../partials/resourceHeader', {res: res}); %>

        <h4>Status</h4><%= res.status %>

        <h4>Outcome</h4><%= res.outcome %>
        <h4>Created</h4><%= res.created %>

        <%- include('../partials/codeableConcept', {codeableConcepts: [res.type], name: "Type"}); %>

        <%- include('../partials/reference', {references: [res.patient], name: "Patient"}); %>

        <%- include('../partials/reference', {references: [res.insurer], name: "Insurer"}); %>

        <%- include('../partials/reference', {references: [res.provider], name: "Provider"}); %>

        <%- include('../partials/reference', {references: [res.claim], name: "Claim"}); %>

        <% if (res.item) { %>
        <div>
            <h4>Items</h4>
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Sequence</th>
                  <th scope="col">Date</th>
                  <th scope="col">Code</th>
                  <th scope="col">Quantity</th>
                </tr>
              </thead>
              <tbody>
            <% res.item.forEach(function(item){ %>
                <tr>
                <td><%= item.sequence %></td>
                <td><%= item.servicedDate %></td>
                <td>
                    <% if (item.productOrService) { %>
                        <% item.productOrService.coding.forEach(function(coding){ %>
                            <%= coding.code %> (<%= coding.system %>)
                        <%})%>
                    <%}%>
                 </td>
                 <td>
                    <% if (item.quantity) { %>
                        <%= item.quantity.value %>
                    <%}%>
                 </td>
                 </tr>
            <%})%>
              </tbody>
            </table>
        </div>
        <%}%>

        <% if (res.careTeam) { %>
        <div>
            <h4>Care Team</h4>
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Sequence</th>
                  <th scope="col">Provider</th>
                </tr>
              </thead>
              <tbody>
            <% res.careTeam.forEach(function(item){ %>
                <tr>
                    <td><%= item.sequence %></td>
                    <td><a href="/4_0_0/<%= item.provider.reference %>"><%= item.provider.reference %></a></td>
                 </tr>
            <%})%>
              </tbody>
            </table>
        </div>
        <%}%>

        <% if (res.insurance) { %>
        <div>
            <h4>Insurance</h4>
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Focal</th>
                  <th scope="col">Coverage</th>
                </tr>
              </thead>
              <tbody>
            <% res.insurance.forEach(function(item){ %>
                <tr>
                    <td><%= item.focal %></td>
                    <td><a href="/4_0_0/<%= item.coverage.reference %>"><%= item.coverage.reference %></a></td>
                 </tr>
            <%})%>
              </tbody>
            </table>
        </div>
        <%}%>

        <% if (res.total) { %>
        <div>
            <h4>Totals</h4>
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">id</th>
                  <th scope="col">Code</th>
                  <th scope="col">Amount</th>
                </tr>
              </thead>
              <tbody>
            <% res.total.forEach(function(total){ %>
                <tr>
                <td><%= total.id %></td>
                <td>
                    <% if (total.category) { %>
                        <% total.category.coding.forEach(function(coding){ %>
                            <%= coding.code %> (<%= coding.system %>)
                        <%})%>
                    <%}%>
                 </td>
                 <td>
                    <% if (total.amount) { %>
                        <%= total.amount.value %>
                    <%}%>
                 </td>
                 </tr>
            <%})%>
              </tbody>
            </table>
        </div>
        <%}%>

        <% if (res.supportingInfo) { %>
        <div>
            <h4>Supporting Info</h4>
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Sequence</th>
                  <th scope="col">Code</th>
                  <th scope="col">Value</th>
                </tr>
              </thead>
              <tbody>
            <% res.supportingInfo.forEach(function(item){ %>
                <tr>
                <td><%= item.sequence %></td>
                <td>
                    <% if (item.category && item.category.coding) { %>
                        <% item.category.coding.forEach(function(coding){ %>
                            <%= coding.code %> (<%= coding.system %>)
                        <%})%>
                    <%}%>
                 </td>
                 <td>
                    <% if (item.valueQuantity) { %>
                        <%= item.valueQuantity.value %>
                    <%} else if (item.code && item.code.coding && item.code.coding.length > 0) { %>
                        <% item.code.coding.forEach(function(coding){%>
                            <%= coding.code %> <% if (item.valueString) {%>(<%= item.valueString %>)<%}%>
                        <%})%>
                    <%} else if (item.valueString) { %>
                        <%= item.valueString %>
                    <%}%>
                 </td>
                 </tr>
            <%})%>
              </tbody>
            </table>
        </div>
        <%}%>


        <%- include('../partials/json', {res: res}); %>
    <%})%>
  </div>
</main>

<footer>
  <%- include('../partials/footer', {url: url}); %>
</footer>

</body>
</html>
